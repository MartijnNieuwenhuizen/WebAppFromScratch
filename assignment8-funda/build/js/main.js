!function e(t,n,o){function i(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,n){!function(){"use strict";var t=e("./routes/routes"),n=e("./modules/firstVisitToday"),o={launcher:function(){t.init(),n.check()}};o.launcher()}()},{"./modules/firstVisitToday":4,"./routes/routes":11}],2:[function(e,t,n){var o=e("./htmlElements"),i=e("./userSettings"),r=e("./funda"),s=(e("./dataFilter"),e("../view/template")),u=e("./spinner"),a=e("./pushMessage");assembleComponents={allHouses:function(){u.start(),r.returnAllHouses().then(function(e){a.pushNewHouses(),s.render(o.houseList.innerHTML,e).then(function(){o.main.classList.add("fade-in"),setTimeout(function(){o.main.classList.remove("fade-in")},1e3)})})},newHouses:function(){u.start(),r.returnNewHouses().then(function(e){s.render(o.newHouses.innerHTML,e).then(function(){o.main.classList.add("fade-in"),setTimeout(function(){o.main.classList.remove("fade-in")},1e3)})})},settings:function(){u.start(),i.checkLocalStorage()},error:function(){var e={title:"404",message:"Sorry page not found"};s.render(o.error.innerHTML,e)}},t.exports=assembleComponents},{"../view/template":12,"./dataFilter":3,"./funda":5,"./htmlElements":6,"./pushMessage":8,"./spinner":9,"./userSettings":10}],3:[function(e,t,n){var o=e("../modules/local-storage"),i={devideHouses:function(e){return new Promise(function(t,n){var o=e,i=o.Objects,r=[],s=[];_.filter(i,function(e){"Vandaag"===e.AangebodenSindsTekst?(e.today=!0,r.push(e)):s.push(e)});var u={data:o,addedToday:r,notAddedToday:s};t(u)})},filterNewHouses:function(e){return new Promise(function(t,n){var o=e,i=o.Objects,r=[];_.filter(i,function(e){"Vandaag"===e.AangebodenSindsTekst&&(e.today=!0,r.push(e))}),t(r)})},combineHousesData:function(e){var t=e,n=t.data,i=t.addedToday,r=t.notAddedToday;return new Promise(function(e,t){o.get("userSettings").then(function(t){var o=t,s={city:o.city,budget:"€"+o.minPrice+" - €"+o.maxPrice,total:n.TotaalAantalObjecten,totalToday:i.length},u=i.concat(r),a={meta:s,houses:u};e(a)})})},returnAllHouses:function(e){return new Promise(function(t,n){i.devideHouses(e).then(i.combineHousesData).then(function(e){t(e)})})}};t.exports=i},{"../modules/local-storage":7}],4:[function(e,t,n){var o=e("./local-storage"),i=e("./pushMessage"),r={check:function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,s=e.getFullYear(),u=n+"/"+t+"/"+s;o.get("today").then(function(e){e?(u>e&&i.pushNewHouses(),r.setNewDate(u)):r.setNewDate(u)})["catch"](function(){r.setNewDate(u)})},setNewDate:function(e){return o.set("today",e)}};t.exports=r},{"./local-storage":7,"./pushMessage":8}],5:[function(e,t,n){var o=(e("./pushMessage"),e("./htmlElements")),i=e("./local-storage"),r=e("./dataFilter"),s=e("../view/template"),u={APICall:function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.onloadend=function(e){t(o.response)},o.onerror=n,o.open("GET",e,!0),o.send()})},APIUrl:function(e){var t;if(e){var n=e;return url={BaseUrl:"http://funda.kyrandia.nl/feeds/Aanbod.svc",key:"e2d60e885b8742d4b0648300e3703bd7",type:"type=koop",city:n.city,radius:n.radius,minPrice:n.minPrice,maxPrice:n.maxPrice,pageNumber:"&page=1",pageSize:"&pagesize=25","new":n["new"]},n["new"]?(url["new"]=n["new"],t=url.BaseUrl+"/json/"+url.key+"/?"+url.type+"&zo=/"+url.city+"/+"+url.radius+"km/"+url.minPrice+"-"+url.maxPrice+"/"+url["new"]):t=url.BaseUrl+"/json/"+url.key+"/?"+url.type+"&zo=/"+url.city+"/+"+url.radius+"km/"+ +url.minPrice+"-"+url.maxPrice+"/"+url.pageNumber+url.pageSize}userSettings.checkLocalStorage()},returnAllData:function(){return new Promise(function(e,t){var n=i.get("userSettings").then(u.APIUrl).then(u.APICall).then(function(t){if(n=JSON.parse(t),0===n.TotaalAantalObjecten){var i={title:"Geen Matches",message:"Sorry, er zijn geen huizen gevonden in deze catagorie"};s.render(o.error.innerHTML,i)}e(n)})["catch"](function(e){window.location.hash="#settings"})})},returnNewHouses:function(){return new Promise(function(e,t){u.returnAllData().then(r.filterNewHouses).then(function(t){e(t)})["catch"](function(e){console.error(e.stack?e.stack:e)})})},returnAllHouses:function(){return new Promise(function(e,t){u.returnAllData().then(r.returnAllHouses).then(function(t){e(t)})["catch"](function(e){console.error(e.stack?e.stack:e)})})}};t.exports=u},{"../view/template":12,"./dataFilter":3,"./htmlElements":6,"./local-storage":7,"./pushMessage":8}],6:[function(e,t,n){var o={main:document.querySelector("main"),settingsForm:document.querySelector("#settingsForm"),houseList:document.querySelector("#houseList"),newHouses:document.querySelector("#new-houses"),loading:document.querySelector("#loading"),error:document.querySelector("#error")};t.exports=o},{}],7:[function(e,t,n){var o={set:function(e,t){return new Promise(function(n,o){var i=JSON.stringify(t);localStorage.setItem(e,i),n(),o()})},get:function(e){return new Promise(function(t,n){var o=localStorage.getItem(e),i=JSON.parse(o);t(i)})}};t.exports=o},{}],8:[function(e,t,n){var o=(e("../modules/dataFilter"),e("../modules/funda")),i=e("../modules/local-storage"),r={confirm:function(){new Promise(function(e,t){return Notification.requestPermission(),e()}).then(function(){var e={title:"Gelukt",body:"Elke dag krijgt u een push notificatie met passende huizen die zijn toegevoegd terwijl u sliep ",icon:"../img/funda-logo.png",link:null};this.showNotification(e),window.location.hash="#thuis/"+settings.city})},showNotification:function(e){var t=e,n=new Notification(t.title,{icon:t.icon,body:t.body});n.onclick=function(){null!=t.link?window.location.hash="#thuis-vandaag/:city":n.close()}},pushNewHouses:function(){o.returnNewHouses().then(function(e){if(e.length)i.get("userSettings").then(function(t){var n=t,o=(e.length,{body:"zie meer!",icon:e[0].Foto,link:"/funda/#thuis-vandaag/"+n.city});e.length>1?o.title="Er zijn vandaag "+e.length+" mogelijke huizen toegevoegd in "+n.city:o.title="Er is vandaag 1 mogelijk thuis toegevoegd in "+n.city,r.showNotification(o)});else{var t={title:"Helaas",body:"Er zijn vandaag geen niewe huizen toegevoegd",icon:"../img/funda.png",link:null};r.showNotification(t)}})}};t.exports=r},{"../modules/dataFilter":3,"../modules/funda":5,"../modules/local-storage":7}],9:[function(e,t,n){var o=e("./htmlElements"),i=e("../view/template"),r={start:function(){i.render(o.loading.innerHTML)}};t.exports=r},{"../view/template":12,"./htmlElements":6}],10:[function(e,t,n){var o=e("../modules/htmlElements"),i=e("../view/template"),r=e("./local-storage"),s=e("./pushMessage"),u={checkLocalStorage:function(){r.get("userSettings").then(function(e){var t={action:"Veranderen uw instellngen"};u.showForm(t),u.retreveSettings(e)})["catch"](function(){var e={action:"Sla uw instellingen op"};u.showForm(e)})},showForm:function(e){i.render(o.settingsForm.innerHTML,e).then(function(){var e=document.querySelector("#submit-button");e.addEventListener("click",u.saveSettings,!1)})},retreveSettings:function(e){var t=e;document.querySelector("#city").value=t.city,document.querySelector("#radius").value=t.radius,document.querySelector("#min-price").value=t.minPrice,document.querySelector("#max-price").value=t.maxPrice,document.querySelector("#notification").checked=t.notification},saveSettings:function(){settings={city:document.querySelector("#city").value.toLowerCase(),radius:document.querySelector("#radius").value,minPrice:document.querySelector("#min-price").value,maxPrice:document.querySelector("#max-price").value,notification:document.querySelector("#notification").checked},r.set("userSettings",settings).then(function(){"granted"===Notification.permission?window.location.hash="#thuis/"+settings.city:s.confirm()})}};t.exports=u},{"../modules/htmlElements":6,"../view/template":12,"./local-storage":7,"./pushMessage":8}],11:[function(e,t,n){var o=(e("../modules/htmlElements"),e("../view/template"),e("../modules/assembleComponents")),i={init:function(){routie({"":function(){window.location.hash="#thuis/city"},settings:function(){o.settings()},"thuis-vandaag/:city":function(){o.newHouses()},"thuis/:city":function(){o.allHouses()},"*":function(){o.error()}})}};t.exports=i},{"../modules/assembleComponents":2,"../modules/htmlElements":6,"../view/template":12}],12:[function(e,t,n){var o=e("../modules/htmlElements"),i={render:function(e,t){return new Promise(function(n,i){var r=Handlebars.compile(e),s=r(t);o.main.innerHTML=s,n()})}};t.exports=i},{"../modules/htmlElements":6}]},{},[1]);